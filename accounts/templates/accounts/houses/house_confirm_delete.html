{% extends 'accounts/base.html' %}
{% load static %}

{% block title %}Delete House{% endblock %}

{% block content %}
<div class="row mb-4">
  <div>
    <div>
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
        <path d="M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2m3 0v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6h14zM10 11v6M14 11v6"/>
      </svg>
    </div>
    <div>
      <h1>Delete House</h1>
      <p>This action cannot be undone</p>
    </div>
  </div>
  <div>
    <a href="{% url 'accounts:house_detail' property.pk %}" class="btn btn-primary-secondary">‚Üê Back to House</a>
  </div>
</div>

<div>
  <!-- Warning Card -->
  <div>
    <div>
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2">
        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
        <line x1="12" y1="9" x2="12" y2="13"/>
        <line x1="12" y1="17" x2="12.01" y2="17"/>
      </svg>
      <h3>Warning: Permanent Action</h3>
    </div>
    <p>
      You are about to permanently delete this property. This action cannot be undone and will remove:
    </p>
    <ul>
      <li>All property information and details</li>
      <li>All uploaded images</li>
      <li>All view history and analytics</li>
      <li>All favorite records from users</li>
    </ul>
  </div>

  <!-- Property Preview -->
  <div>
    <h3>Property to Delete</h3>
    
    <div>
      <!-- Property Image -->
      <div style="width: 120px; height: 90px; border-radius: 8px; overflow: hidden; background: #f1f5f9; flex-shrink: 0;">
        {% if property.images.first %}
          <img src="{{ property.images.first.image.url }}" alt="{{ property.title }}" 
              >
        {% else %}
          <div>
            <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 3l10 9h-3v9h-6v-6H11v6H5v-9H2z"/>
            </svg>
          </div>
        {% endif %}
      </div>
      
      <!-- Property Details -->
      <div>
        <h4>{{ property.title }}</h4>
        <p>{{ property.property_type.name }} in {{ property.region.name }}</p>
        <div>
          <span>{{ property.bedrooms }} bed{{ property.bedrooms|pluralize }}</span>
          <span>{{ property.bathrooms }} bath{{ property.bathrooms|pluralize }}</span>
          <span>{{ property.size_sqft }} sqft</span>
        </div>
        <div>
          ${{ property.rent_amount|floatformat:0 }}/month
        </div>
      </div>
    </div>
  </div>

  <!-- Confirmation Form -->
  <form method="post">
    {% csrf_token %}
    
    <h3>Confirm Deletion</h3>
    
    <div>
      <p>
        To confirm deletion, type the property title exactly as shown: 
        <strong>"{{ property.title }}"</strong>
      </p>
    </div>
    
    <div>
      <label for="confirm-title">
        Property Title Confirmation
      </label>
      <input 
        type="text" 
        id="confirm-title" 
        name="confirm_title"
        required
       
        placeholder="Type the property title to confirm"
      >
    </div>
    
    <div>
      <a href="{% url 'accounts:house_detail' property.pk %}" class="btn btn-primary-secondary">
        Cancel
      </a>
      <button 
        type="submit" 
        class="btn btn-primary-danger"
        onclick="return confirmDeletion()"
       >
        Delete Property
      </button>
    </div>
  </form>
</div>

<script>
function confirmDeletion() {
  const confirmTitle = document.getElementById('confirm-title').value;
  const propertyTitle = "{{ property.title|escapejs }}";
  
  if (confirmTitle !== propertyTitle) {
    alert('Property title does not match. Please type the exact title to confirm deletion.');
    return false;
  }
  
  return confirm('Are you absolutely sure you want to delete this property? This action cannot be undone.');
}
</script>
{% endblock %}